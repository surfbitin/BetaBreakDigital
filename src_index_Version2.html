<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="theme-color" content="#000000">
  <title>Beta Break Digital</title>
  <meta name="description" content="Beta Break Digital - a digital implementation of the Beta Break‚Ñ¢ climbing game.">
  
  <link rel="manifest" href="manifest.json">
  <link rel="icon" href="icons/icon-192.png">
  <link rel="stylesheet" href="style.css">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&display=swap" rel="stylesheet">
</head>
<body>
  <div id="app" class="app-container">
    <h1 class="text-3xl font-extrabold text-center mb-6 text-gray-800">Beta Break Digital</h1>
    <!-- Game Setup Screen -->
    <div id="setup-screen" class="section-card" role="region" aria-label="Game Setup">
      <h2 class="text-xl font-bold mb-4 text-gray-700 border-b pb-2">1. Game Setup</h2>
      
      <div class="mb-4">
        <label for="routeLength" class="text-sm font-bold text-gray-700" style="display:block; margin-bottom:0.25rem;">Route Handhold Count (Must be 5+)</label>
        <input type="number" id="routeLength" value="10" min="5" class="input-field" onchange="updateDeckEstimate()" aria-label="Route Handhold Count">
        <p id="deck-estimate" class="text-xs text-gray-500 mt-1">Recommended Eliminate Cards: 6</p>
      </div>

      <h2 class="text-xl font-bold mb-4 text-gray-700 border-b pb-2">2. Add Climbers</h2>
      <div id="player-inputs" style="margin-bottom: 1.5rem;">
        <div class="flex gap-2" style="margin-bottom: 0.75rem;">
          <input type="text" placeholder="Climber 1 Name" class="input-field" value="Climber A" aria-label="Climber 1 Name">
        </div>
        <div class="flex gap-2" style="margin-bottom: 0.75rem;">
          <input type="text" placeholder="Climber 2 Name" class="input-field" value="Climber B" aria-label="Climber 2 Name">
        </div>
      </div>
      
      <button onclick="addClimberInput()" class="btn btn-outline mb-6" aria-label="Add Another Climber">
        + Add Another Climber
      </button>

      <div style="border-top: 1px solid #e5e7eb; padding-top: 1rem;">
        <p class="text-xs text-gray-500 text-center font-medium">
          Beta Break Digital based on the original <strong>Beta Break‚Ñ¢</strong> game.
          Game design by <strong>Caleb J. Ross</strong>. Card design/art by <strong>Madison Turner</strong>.
          &copy; 2025 Ross Publishing, LLC.
        </p>
      </div>

      <button id="start-game-btn" onclick="startGame()" class="btn btn-green text-xl mt-4" aria-label="Start Game">
        Start Game
      </button>
    </div>

    <!-- Game Screen -->
    <div id="game-screen" class="hidden w-full" role="region" aria-label="Game Screen">
      <!-- Status Card -->
      <div class="section-card" style="border-top: 4px solid #3b82f6;">
        <h2 class="text-2xl font-bold mb-4 text-gray-800 flex justify-between items-center">
          Current Game Status
          <span id="problem-holds" class="text-sm font-normal bg-gray-100 px-3 py-1 rounded-lg text-gray-700 border border-gray-200">Holds: N/A</span>
        </h2>
        <div class="grid md:grid-cols-2 gap-4">
          <div class="bg-blue-50 p-4 rounded-lg border-l-4 border-blue-500">
            <p class="text-sm font-medium text-blue-700">Current Climber</p>
            <p id="current-climber-name" class="text-xl font-extrabold text-blue-900 truncate">Waiting...</p>
          </div>
          <div class="bg-yellow-50 p-4 rounded-lg border-l-4 border-yellow-500">
            <p class="text-sm font-medium text-yellow-700">Cards Remaining</p>
            <p id="cards-remaining-count" class="text-xl font-extrabold text-yellow-900">0</p>
          </div>
        </div>
      </div>
      <!-- Active Cards/Effects -->
      <div class="section-card">
        <h2 class="text-xl font-bold mb-4 text-gray-700 border-b pb-2">Active Problem Effects</h2>
        <div id="active-beta-display" class="mb-4 p-4 rounded-lg bg-indigo-50 border-l-4 border-indigo-400">
          <p class="active-card-title text-indigo-700 border-indigo-700">Active Beta</p>
          <div id="active-beta-content" class="text-gray-900 text-sm">Waiting for game start...</div>
        </div>
        <div id="active-break-display" class="mb-4 p-4 rounded-lg bg-orange-50 border-l-4 border-orange-400">
          <p class="active-card-title text-orange-700 border-orange-700">Active Break</p>
          <div id="active-break-content" class="text-gray-900 text-sm">Waiting for game start...</div>
        </div>
        <div id="eliminated-holds-display" class="mt-4">
          <p class="text-md font-bold mb-2 text-red-700">Eliminated Holds:</p>
          <div id="eliminated-holds-list" class="flex flex-wrap gap-2">
            <p class="text-sm text-gray-500 italic">None so far.</p>
          </div>
        </div>
      </div>
      <!-- Player Status/Actions -->
      <div class="section-card">
        <h2 class="text-xl font-bold mb-4 text-gray-700 border-b pb-2">Player Status</h2>
        <div id="player-list" style="margin-bottom: 1.5rem;">
        </div>
        <div id="climber-actions" style="border-top: 1px solid #e5e7eb; padding-top: 1rem;">
          <button id="draw-card-btn" onclick="drawCard()" class="btn btn-blue text-lg shadow-md" aria-label="Draw Card & Start Turn">
            Draw Card & Start Turn
          </button>
          <div id="send-outcome-buttons" class="hidden grid grid-cols-2 gap-4 mt-4">
            <button onclick="recordSendOutcome(true)" class="btn btn-green shadow-md" aria-label="Succeeded Send">
              Succeeded Send
            </button>
            <button onclick="recordSendOutcome(false)" class="btn btn-red shadow-md" aria-label="Failed Send">
              Failed Send
            </button>
          </div>
        </div>
        <div class="flex gap-2 mt-4">
          <button onclick="showRules()" class="btn btn-outline" style="width: 50%;" aria-label="View Rules">View Rules</button>
          <button onclick="resetGame()" class="btn btn-outline" style="width: 50%;" aria-label="New Game">New Game</button>
        </div>
      </div>
    </div>

    <!-- Card Modal -->
    <div id="drawn-card-overlay" class="overlay hidden">
      <div class="card-modal-container" id="drawn-card-modal" role="dialog" aria-modal="true" aria-label="Card Modal">
        <div class="card-image-bg" id="drawn-card-image" style="background-image: url('https://placehold.co/400x600/3b82f6/ffffff?text=CARD');" alt="Drawn Card"></div>
        <div class="card-content">
          <div>
            <p id="drawn-card-type" class="text-sm font-bold mb-1 text-gray-500 uppercase"></p>
            <h3 id="drawn-card-name" class="text-2xl font-extrabold mb-4 text-gray-800">Card Name</h3>
            <div id="drawn-card-description" class="text-gray-700 text-base leading-relaxed overflow-y-auto max-h-56">Card Description</div>
          </div>
          <button onclick="acknowledgeCard()" class="btn btn-green mt-4 shadow-md" aria-label="Acknowledge Card & Continue">
            Acknowledge Card & Continue
          </button>
        </div>
      </div>
    </div>
    
    <!-- Eliminate Modal -->
    <div id="eliminate-modal" class="overlay hidden">
      <div class="section-card" style="width: 100%; max-width: 24rem; border-top: 4px solid #ef4444;" role="dialog" aria-modal="true">
        <h3 class="text-xl font-bold mb-4 text-red-700">Eliminate a Hold!</h3>
        <p class="mb-4 text-gray-700 text-sm">The current Climber must name the hold they are eliminating.</p>
        <input type="text" id="eliminated-hold-name" placeholder="E.g., Blue crimp on left" class="input-field mb-4" aria-label="Hold Name">
        <button onclick="confirmEliminateHold()" class="btn btn-red shadow-md" aria-label="Confirm Elimination">
          Confirm Elimination
        </button>
      </div>
    </div>
    
    <!-- Winner Modal -->
    <div id="winner-modal" class="overlay hidden">
      <div class="section-card text-center" style="width: 100%; max-width: 28rem; border-top: 4px solid #16a34a;" role="dialog" aria-modal="true">
        <p class="text-3xl mb-4">üèÜ</p>
        <h3 class="text-3xl font-extrabold text-blue-700 mb-2">Game Over!</h3>
        <p id="winner-name" class="text-2xl font-bold text-gray-800 mb-6">The Winner is:</p>
        <button onclick="resetGame()" class="btn btn-blue shadow-md" aria-label="Play Again">
          Play Again
        </button>
      </div>
    </div>
    
    <!-- Rules Modal -->
    <div id="rules-modal" class="overlay hidden">
      <div class="rules-modal-content" role="dialog" aria-modal="true" aria-label="Game Rules">
        <div class="flex justify-between items-center border-b pb-2 mb-4">
          <h2 class="text-2xl font-bold text-gray-800">Rules & Glossary</h2>
          <button onclick="hideRules()" class="text-gray-500 hover:text-gray-700 font-bold text-xl" style="padding: 0 0.5rem;" aria-label="Close">&times;</button>
        </div>
        
        <!-- Rules content omitted for brevity, but keep as in your original -->
        <!-- ... -->
        
        <button onclick="hideRules()" class="btn btn-blue mt-4" aria-label="Close Rules">Close</button>
      </div>
    </div>
  </div>
  
  <script src="main.js"></script>
  <script>
    // Service Worker Registration (assume /service-worker.js at project root)
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
        navigator.serviceWorker.register('/service-worker.js')
          .then(reg => console.log('SW registered:', reg.scope))
          .catch(err => console.error('SW registration failed:', err));
      });
    }
  </script>
</body>
</html>